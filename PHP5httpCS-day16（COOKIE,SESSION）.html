<html>
<head>
  <title>PHP5httpCS-day16（COOKIE,SESSION）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303788 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1451"/>
<h1>PHP5httpCS-day16（COOKIE,SESSION）</h1>

<div>
<span><div><span style="font-size: 21px;"><b>PHP5httpCS-day16（COOKIE,SESSION）</b></span></div><div><span style="font-size: 19px;"><b>一、</b><b><b>COOKIE</b></b></span></div><div align="justify" style="min-height: 14pt;"><div style="margin-left:40px;"><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">COOKIE记录用户信息数据</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">(</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">网站自动登录、记录用户爱好、购物车等</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">)</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">。</span></font></div><div style="margin-left:40px;"><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">COOKIE</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">数据是</span></font><font color="#0000FF" face="宋体" size="2"><span style="font-size:10pt">由服务器</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">来生成，并传回到</span></font><font color="#0000FF" face="宋体" size="2"><span style="font-size:10pt">客户端，可以保存在服务器或客户端。</span></font></div><div><b><span style="font-size: 19px;"><b>     使用</b><b>COOKIE</b><b>的特点</b></span></b></div><div style="margin-left:40px;">实现网站自动登录，可以跟踪用户，并记录用户状态。记录一些用户的爱好，下次访问时：产品推送。</div><div style="margin-left:40px;">购物车。你曾经浏览过的商品可以记录下来。简单加密不安全，保存数量有限。</div><div><b><span style="font-size: 19px;"><b>     COOKIE</b><b>的工作原理</b></span></b></div><div align="justify" style="min-height: 255pt;"><div>          <img src="PHP5httpCS-day16（COOKIE,SESSION）_files/Image.png" type="image/png" style="height:auto;" width="492"/></div></div><div><span style="font-size: 19px;"><b>1、设置</b><b>COOKIE</b></span></div><ul><li>描述：发送一个COOKIE到客户端。</li><li>语法：<b>bool setcookie ( string $name [, string $value [, int $expire = 0 [, string $path [, string $domain [, bool $secure = false [, bool $httponly = false ]]]]]] )</b></li></ul><div><b>     例：<span style="font-size: 16px;">setcookie(&quot;username&quot;,'admin',time()+3600,&quot;/&quot;,&quot;.wdc.com&quot;,false,false);</span></b></div><ul><li>参数：$expire，COOKIE的有效期，默认是0，表示关闭浏览器COOKIE就失效了。1<font color="#0000FF" face="宋体" size="2"><span style="font-size:10pt"><b>即时性</b></span></font> 2<font color="#0000FF" face="宋体" size="2"><span style="font-size:10pt"><b>过期时间time()+N秒</b></span></font>3<font color="#0000FF" face="宋体" size="2"><span style="font-size:10pt"><b>永久过期时间PHP_INT_MAX</b></span></font><ul><li style="display:inline;list-style:none;"><ul><li>$path，COOKIE的有效路径。</li><li>$domain，COOKIE的有效域名。</li><li>$secure，是否仅能使用https来传送COOKIE。</li><li>$httponly，是否只能通过http协议来使用COOKIE。</li></ul></li></ul></li></ul><div align="justify" style="min-height: 14pt;"><div><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">     COOKIE</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">的名称和值$value类型:<b>只能</b>是<b>字符串</b>、值还可是能<b>直接转换</b></span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">为字符串</span></font>的<font color="#010101" face="宋体" size="2"><span style="font-size:10pt">(</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">字符串、数字、布尔)</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">,不能是其他值。</span></font></div><div><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">     例setcookie(&quot;username&quot;,implode(array(1,2,3)));//</span></font>Cookie <b><code>username=123</code></b><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">自动转为字符串，可以</span></font></div></div><div>               读取Cookie：<i><b>setcookie(&quot;lasttime&quot;,date('Y-m-d H:i:s',time()));</b></i> <i><b>  echo &quot;$_COOKIE[lasttime]&quot;;//2017-01-16 10:45:20</b></i></div><div><font size="2"><span style="font-size:10pt"><b><span style="font-family: 宋体;"><span style="color: rgb(0, 0, 255);">     设置一个过期时间</span></span></b></span></font>$expire <font size="2"><span style="font-size:10pt"><b><span style="font-family: 宋体;"><span style="color: rgb(0, 0, 255);">例：</span></span>setcookie(&quot;username&quot;,&quot;user&quot;,time()+3600);</b></span></font></div><div align="justify" style="min-height: 18pt;"><div><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><b>2</b></span></font><font color="#010101" face="宋体" size="4"><span style="font-size:14pt"><b>、</b></span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><b>COOKIE</b></span></font><font color="#010101" face="宋体" size="4"><span style="font-size:14pt"><b>有效</b></span></font><font color="#010101" face="宋体" size="4"><span style="font-size:14pt"><b>$path</b></span></font> <font color="#010101" face="宋体" size="4"><span style="font-size:14pt"><b>路径</b></span></font></div></div><div><ul style="margin-top: 0mm; margin-bottom: 0mm; margin-left: 0mm; padding-left: 0pt;list-style-type: disc;"><li style="display:inline;list-style:none;"><ul><li style="margin-left: 15pt; margin-right: 0pt; padding-left: 3pt; text-indent:0pt; font-size: 10pt; color: #010101;"><div align="justify" style="min-height: 14pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt; font-family:����; color:#010101; font-weight:Normal; font-style:Normal; font-decoration:Normal">默认是</span></font><font color="#FF0000" face="宋体" size="2"><span style="font-size:10pt">网站根目录</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">“</span></font><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">/</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">”。换句话说：在本网站的</span></font><font color="#FF0000" face="宋体" size="2"><span style="font-size:10pt">任何子目录下</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">都可以使用该</span></font><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">COOKIE</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">。</span></font></div></li><li style="margin-left: 15pt; margin-right: 0pt; padding-left: 3pt; text-indent:0pt; font-size: 10pt; color: #010101;"><div align="justify" style="min-height: 14pt;"><font color="#0000FF" face="Times New Roman" size="2"><span style="font-size:10pt; font-family:Times New Roman; color:#0000ff; font-weight:Normal; font-style:Normal; font-decoration:Normal">setcookie(‘username’ , ‘admin’ , 0 , ‘/upload/’)</span></font> <font color="#FF0000" face="Times New Roman" size="2"><span style="font-size:10pt">//</span></font><font color="#FF0000" face="宋体" size="2"><span style="font-size:10pt">该</span></font><font color="#FF0000" face="Times New Roman" size="2"><span style="font-size:10pt">COOKIE</span></font><font color="#FF0000" face="宋体" size="2"><span style="font-size:10pt">数据只能在</span></font><font color="#FF0000" face="Times New Roman" size="2"><span style="font-size:10pt">upload</span></font><font color="#FF0000" face="宋体" size="2"><span style="font-size:10pt">目录及其子目录下使用</span></font></div></li></ul></li></ul></div><div><div align="justify" style="min-height: 18pt;"><div><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><b>3</b></span></font><font color="#010101" face="宋体" size="4"><span style="font-size:14pt"><b>、</b></span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><b>COOKIE</b></span></font><font color="#010101" face="宋体" size="4"><span style="font-size:14pt"><b>域名</b></span></font><font color="#010101" face="宋体" size="4"><span style="font-size:14pt"><b>$domain</b></span></font><font color="#010101" face="宋体" size="4"><span style="font-size:14pt"><b>有效性</b></span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt; font-family:����; color:#010101; font-weight:Normal; font-style:Normal; font-decoration:Normal">默认值为当前域名，只可以用在当前域名下</span></font></div></div><ul style="margin-top: 0mm; margin-bottom: 0mm; margin-left: 0mm; padding-left: 0pt;list-style-type: disc;"><li style="margin-left: 15pt; margin-right: 0pt; padding-left: 3pt; text-indent:0pt; font-size: 10pt; color: #010101;"><div align="justify" style="min-height: 13pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt; font-family:����; color:#010101; font-weight:Normal; font-style:Normal; font-decoration:Normal">举例：</span></font></div><ul style="margin-top: 0mm; margin-bottom: 0mm; margin-left: 0mm; padding-left: 0pt;list-style-type: disc;"><li style="list-style-type: none;"><ul style="margin-top: 0mm; margin-bottom: 0mm; margin-left: 0mm; padding-left: 0pt;list-style-type: disc;"><li style="margin-left: 36pt; margin-right: 0pt; padding-left: 3pt; text-indent:0pt; font-size: 10pt; color: #010101;"><div align="justify" style="min-height: 14pt;"><font color="#0000FF" face="Times New Roman" size="2"><span style="font-size:10pt; font-family:Times New Roman; color:#0000ff; font-weight:Normal; font-style:Normal; font-decoration:Normal">setcookie(‘username’ , ‘admin’ , 0 , ‘/’ , ‘</span></font><font color="#FF0000" face="Times New Roman" size="2"><span style="font-size:10pt">.2016.cn</span></font><font color="#0000FF" face="Times New Roman" size="2"><span style="font-size:10pt">’)</span></font><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">  //</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">设置主域名、一级域名，可以在任何子域名下使用---------------------------------</span></font></div></li><li style="margin-left: 36pt; margin-right: 0pt; padding-left: 3pt; text-indent: 0pt;"><div align="justify" style="min-height: 14pt;"><font color="#0000FF" face="Times New Roman" size="2"><span style="font-size:10pt; font-family:Times New Roman; color:#0000ff; font-weight:Normal; font-style:Normal; font-decoration:Normal">setcookie(‘username’ , ‘admin’ , 0 , ‘/’ , ‘</span></font><font color="#FF0000" face="Times New Roman" size="2"><span style="font-size:10pt">www.2016.cn</span></font><font color="#0000FF" face="Times New Roman" size="2"><span style="font-size:10pt">’) </span></font> <font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">//</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">二级域名，只能在</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt; font-family:����; color:#010101; font-weight:Normal; font-style:Normal; font-decoration:Normal">当前</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">域名下使用</span></font></div></li><li style="margin-left: 36pt; margin-right: 0pt; padding-left: 3pt; text-indent: 0pt;"><div align="justify" style="min-height: 14pt;"><font color="#0000FF" face="Times New Roman" size="2"><span style="font-size:10pt; font-family:Times New Roman; color:#0000ff; font-weight:Normal; font-style:Normal; font-decoration:Normal">setcookie(‘username’ , ‘admin’ , 0 , ‘/’ , ‘</span></font><font color="#FF0000" face="Times New Roman" size="2"><span style="font-size:10pt">image.2016.cn</span></font><font color="#0000FF" face="Times New Roman" size="2"><span style="font-size:10pt">’) </span></font> <font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">//</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">二级域名，只能在</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt; font-family:����; color:#010101; font-weight:Normal; font-style:Normal; font-decoration:Normal">当前</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">域名下使用</span></font></div></li><li style="margin-left: 36pt; margin-right: 0pt; padding-left: 3pt; text-indent: 0pt;"><div align="justify" style="min-height: 14pt;"><font color="#0000FF" face="Times New Roman" size="2"><span style="font-size:10pt; font-family:Times New Roman; color:#0000ff; font-weight:Normal; font-style:Normal; font-decoration:Normal">setcookie(‘username’ , ‘admin’ , 0 , ‘/’ , ‘</span></font><font color="#FF0000" face="Times New Roman" size="2"><span style="font-size:10pt">photo.image.2016.cn</span></font><font color="#0000FF" face="Times New Roman" size="2"><span style="font-size:10pt">’) </span></font> <font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">//</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">三级域名，只能</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt; font-family:����; color:#010101; font-weight:Normal; font-style:Normal; font-decoration:Normal">当前</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">本域名下使用</span></font></div></li></ul></li></ul></li></ul></div><div align="justify" style="min-height: 18pt;"><div><font color="#010101" size="4"><span style="font-size:14pt"><b>4、是否仅限</b></span></font><font color="#010101" size="4"><span style="font-size:14pt"><b>https</b></span></font><font color="#010101" size="4"><span style="font-size:14pt"><b>可以发送</b></span></font><font color="#010101" size="4"><span style="font-size:14pt"><b>COOKIE，默认FALSE，如http也可</b></span></font></div></div><div align="justify" style="min-height: 18pt;"><div><font color="#010101" size="4"><span style="font-size:14pt"><b>5</b></span></font><font color="#010101" size="4"><span style="font-size:14pt"><b>、是否只能通过</b></span></font><font color="#010101" size="4"><span style="font-size:14pt"><b>http</b></span></font><font color="#010101" size="4"><span style="font-size:14pt"><b>协议使用</b></span></font><b><font color="#010101" size="4"><span style="font-size:14pt">COOKIE</span></font><font color="#010101">默认FALSE，其他程序也可使用cookie，如JS</font></b></div></div><div><b><span style="font-size: 19px;"><b>6、删除</b><b>COOKIE（5方法）</b></span></b></div><div style="margin-left:40px;"><b>1</b><b>、设置有效时间为过去的时间</b><b>setcookie(&quot;username&quot;,&quot;user&quot;,time()-1);</b></div><div style="margin-left:40px;"><b>2</b><b>、将</b><b>COOKIE</b><b>值设置为</b><b>FALSE：</b><b>setcookie(&quot;username&quot;,false);</b></div><div style="margin-left:40px;"><b>3</b><b>、空字符串</b><b>setcookie(&quot;username&quot;,'');</b></div><div style="margin-left:40px;"><b>4</b><b>、或不设置</b><b>COOKIE</b><b>值</b><b>setcookie(&quot;username&quot;);</b></div><div style="margin-left:40px;"><b>5</b><b>、清除浏览器缓存</b></div><div><b><span style="font-size: 16px;">例：setcookie(&quot;username&quot;,'admin',time()-1,&quot;/&quot;,&quot;.wdc.com&quot;,false,false);//最好指定路径文件夹</span></b></div><div><b><span style="font-size: 19px;">二、SESSION</span></b></div><div align="justify" style="font-weight: bold;"><div><span style="font-size: 19px;"><b>1、什么是</b><b>SESSION</b><b>？</b></span></div></div><div align="justify" style="min-height: 14pt;"><div style="margin-left:40px;"><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">COOKIE</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">将会话数据保存在</span></font><font color="#0000FF" face="宋体" size="2"><span style="font-size:10pt">客户端</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">，而</span></font><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">SESSION</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">是将会话<b>数据</b>存在</span></font><font color="#0000FF" face="宋体" size="2"><span style="font-size:10pt"><b>服务器</b>，</span></font><font color="#010101" face="KaiTi"><span style="font-size:12pt">相对安全</span></font> <font color="#010101" face="宋体" size="2"><span style="font-size:10pt">；</span></font></div></div><div align="left" style="min-height: 13pt;"><div style="margin-left:40px;"><font color="#010101" face="KaiTi"><span style="font-size:12pt">session是另一种记录客户状态的机制。</span></font></div><div style="margin-left:40px;"><span style="font-size: 12pt;"><span style="font-family: KaiTi;"><span style="color: rgb(1, 1, 1);">特点：</span></span></span><font color="#010101" face="KaiTi"><span style="font-size:12pt">session是基于cookie的，</span></font><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">SESSION</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">保存的数据量很大；</span></font></div><div align="justify" style="min-height: 14pt;"><div style="margin-left:40px;"><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">COOKIE</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">保存的数据类型只能是字符串，而</span></font><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">SESSION</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">可以存储所有数据类型，除资源外；</span></font></div><div align="left" style="min-height: 13pt;"><div style="margin-left:40px;"><span style="font-family: 宋体;"><font color="#010101">session在第一次建立的时候，会为用户生成一个独一无二的session<b>id</b>，并<b>保存在cookie中</b>；</font></span></div><div style="margin-left:40px;"><span style="font-family: 宋体;"><font color="#010101">服务器就是通过存储在cookie中的sessionid来识别来访用户的！</font></span></div></div></div></div><div><span style="font-size: 19px;"><b><font color="#010101"><b>2、SESSION</b></font><font color="#010101">工作原理</font></b></span></div><div align="justify" style="min-height: 245pt;"><div>          <img src="PHP5httpCS-day16（COOKIE,SESSION）_files/Image [1].png" type="image/png" alt="graphic" border="0" height="327" style="height:auto;" width="588"/></div></div><div><span style="font-size: 19px;"><b>3、开启</b><b>SESSION</b><b>会话功能</b></span></div><div style="margin-left:40px;">描述：开启一个新的SESSION会话，或者重用一个SESSION会话。语法：<b>bool session_start ( void )</b></div><div style="margin-left:40px;">说明：开启SESSION，就是创建一个SESSION的ID。该ID是唯一的，永不重复，是一个随机的值。</div><div style="margin-left:40px;">注意：一个页面只能开启一次，不能开启第2次。同一个网站，对于某个用户来说，只有一个SESSION的ID。</div><div align="justify" style="font-weight: bold;"><span style="font-size: 19px;"><font color="#010101"><b>4、添加</b></font><font color="#010101"><b>SESSION</b></font><font color="#010101"><b>数据</b></font></span></div><div><ul style="margin-top: 0mm; margin-bottom: 0mm; margin-left: 0mm; padding-left: 0pt;list-style-type: disc;"><li style="display:inline;list-style:none;"><ul><li>语法：$_SESSION[ name ] = value<b>;</b><b>例：$_SESSION['user'][]=array('a','b','c');</b></li><li><b>SESSION</b><b>的名称，可以是字符下标，也可以是整型下标。其值为除资源外类型数据。</b></li></ul></li></ul></div><div><span style="font-size: 19px;"><b>5、读取</b><b>SESSION</b><b>数据（<span style="font-size: 16px;">注意：设置要在开启之前</span>）</b></span></div><div align="justify" style="min-height: 18pt;"><div style="margin-left:40px;"><span style="font-size: 16px;"><font color="#010101"><b>1</b></font><font color="#010101"><b>、获取/设置当前的</b></font><font color="#010101"><b>SESSION</b></font><font color="#010101"><b>－</b></font><font color="#010101"><b>ID</b></font><font color="#010101"><b>值，</b></font></span><span style="font-size: 16px;"><font color="#010101">语法：</font><font color="#0000FF">string <b>session_id</b> ([ string</font> <font color="#0000FF">$id</font> <font color="#0000FF">] )</font></span></div></div><div align="justify" style="min-height: 18pt;"><div style="margin-left:40px;"><span style="font-size: 16px;"><font color="#010101"><b>2</b></font><font color="#010101"><b>、获取当前</b></font><font color="#010101"><b>SESSION</b></font><font color="#010101"><b>的</b></font><font color="#010101"><b>COOKIE</b></font><font color="#010101"><b>数据名称，</b></font></span><span style="font-size: 16px;"><font color="#010101">语法：</font><font color="#0000FF">string <b>session_name</b> ([ string</font> <font color="#0000FF">$name</font> <font color="#0000FF">] )</font></span></div><div style="margin-left:40px;"><span style="font-size: 16px;"><span style="color: rgb(0, 0, 255);">例、print_r(session_id());//</span></span> nmro8te07991t5bf419ku294j6</div></div><div align="justify" style="font-weight: bold; font-size: 15px;"><font color="#010101" face="宋体" size="4"><span style="font-size:16pt"><b>6、删除</b></span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:16pt"><b>SESSION</b></span></font><font color="#010101" face="宋体" size="4"><span style="font-size:16pt"><b>数据</b></span></font></div><div align="justify" style="min-height: 14pt;"><div style="margin-left:40px;"><font size="2"><span style="font-size:10pt"><b>使用</b></span></font><font size="2"><span style="font-size:10pt"><b>unset()</b></span></font><font size="2"><span style="font-size:10pt"><b>来删除单个</b></span></font><font size="2"><span style="font-size:10pt"><b>SESSION</b></span></font><font size="2"><span style="font-size:10pt"><b>数据；          unset($_SESSION['username']);</b></span></font></div><div style="margin-left:40px;"><font size="2"><span style="font-size:10pt"><b>1.1删除全部session_unset();id文件还在，</b></span></font>成为垃圾 <font size="2"><span style="font-size:10pt"><b>    1.2session_destroy();数据内存中还在，但sessionid文件删除。</b></span></font></div></div><div style="margin-left:40px;">注意：删除session时，两步必须都有，缺一不可。</div><div><b>          可以将一个空的数组，赋给</b><b>$_SESSION</b><b>变量。     $_SESSION=array();</b><br/></div><div align="justify"><b><b><font color="#010101" face="宋体" size="4"><span style="font-size:16pt">7、销毁当前</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:16pt">SESSION</span></font></b><font color="#010101" face="宋体" size="4"><span style="font-size:16pt"><b>文件</b></span></font><span style="font-size: 16px;"><span style="color: rgb(1, 1, 1);"><font color="#010101"><span style="color: rgb(1, 1, 1); font-weight: normal; font-style: normal;"><b>语法：</b></span></font><font color="#0000FF">bool session_destroy ( void )</font></span></span></b></div><div align="justify"><span style="color: rgb(1, 1, 1);"><span style="font-size: 16pt;"><span style="font-family: 'Times New Roman';"><b>8、SESSION</b></span></span></span><span style="font-size: 15px;"><b><b><font color="#010101" face="宋体" size="4"><span style="font-size:16pt">在</span></font><font color="#0000FF" face="宋体" size="4"><span style="font-size:16pt">服务器</span></font></b><font color="#010101" face="宋体" size="4"><span style="font-size:16pt"><b>的存储位置</b></span></font></b></span></div><div align="justify" style="min-height: 14pt;"><div><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">     保存在服务器的</span></font><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">C</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">盘下：</span></font><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">C:\WINDOWS\TEMP，</span></font><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">SESSION</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">文件名的格式：</span></font><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">sess_sessID</span></font></div></div><div><b><font color="#010101" face="Times New Roman" size="4"><span style="font-size:16pt"><b>9、SESSION</b></span></font><font color="#010101" face="宋体" size="4"><span style="font-size:16pt">设置：修改</span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:16pt"><b>php.ini</b></span></font><font color="#010101" face="宋体" size="4"><span style="font-size:16pt">文件</span></font></b></div><div style="margin-left:40px;"><b>1</b><b>、修改</b><b>SESSION</b><b>保存位置</b><b>(session.save_path)</b></div><div style="margin-left:40px;"><b>2</b><b>、修改</b><b>SESSION</b><b>名称</b><b>(session.name)</b></div><div style="margin-left:40px;"><b>3</b><b>、使用函数修改</b><b>SESSION</b><b>的</b><b>COOKIE</b><b>的相关参数</b><b>(session_set_cookie_params())</b></div><div style="margin-left:40px;">     针对当前用户的配置称为“脚本级配置”“局部配置”。</div><div>          语法：<b>void</b> <b>session_set_cookie_params (</b> <b>int $lifetime [, string $path [, string $domain [, bool $secure = false [, bool $httponly = false ]]]]</b> <b>)</b></div><div align="justify" style="min-height: 14pt;"><div><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">               参数：$lifetime</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">，过期时间，以秒为单位，直接写秒，</span></font><font color="#FF0000" face="宋体" size="2"><span style="font-size:10pt; font-family:����; color:#ff0000; font-weight:Normal; font-style:Normal; font-decoration:Normal">注意：该函数必须在</span></font><font color="#FF0000" face="Times New Roman" size="2"><span style="font-size:10pt">SESSION_START()</span></font><font color="#FF0000" face="宋体" size="2"><span style="font-size:10pt">之前设置</span></font></div></div><div align="justify"><span style="font-size: 15px;"><b><b><font color="#010101" face="Times New Roman" size="4"><span style="font-size:16pt">10、SESSION</span></font><font color="#010101" face="宋体" size="4"><span style="font-size:16pt">的垃圾回收</span></font></b></b></span><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">garbage collection（已默认设置）</span></font></div><div align="justify" style="min-height: 18pt;"><div style="margin-left:40px;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><b>SESSION</b></span></font><font color="#010101" face="宋体" size="4"><span style="font-size:14pt"><b>垃圾回收时间</b></span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><b>(session.gc_maxlifetime)</b></span></font><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">maxlifetime</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">：最大存活时间</span></font></div></div><div style="margin-left:40px;"><span style="font-size: 16px;"><b>在php.ini中session.gc_maxlifetime = 1440</b></span>//默认24分钟，同时回收概率<font color="#010101" face="Times New Roman"><b>session.gc_divisor</b></font> 太大该过期时间也不生效</div><div style="margin-left:40px;"><div align="justify" style="min-height: 18pt;"><div><font color="#010101" face="宋体" size="4"><span style="font-size:14pt"><b>回收的概率</b></span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><b>(session.gc_probability</b></span></font><font color="#010101" face="宋体" size="4"><span style="font-size:14pt"><b>、</b></span></font><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><b>session.gc_divisor)</b></span></font></div></div></div><div style="margin-left:40px;"><b><span style="font-size: 16px;">session.gc_probability = 1</span>（分子默认1），session.gc_divisor = 1000（分母默认1000）</b></div><div style="margin-left:40px;"><div align="justify" style="min-height: 14pt;"><div><font color="#0000FF" face="宋体" size="2"><span style="font-size:10pt">默认的比率是：</span></font><font color="#0000FF" face="Times New Roman" size="2"><span style="font-size:10pt">1/1000</span></font><font color="#0000FF" face="宋体" size="2"><span style="font-size:10pt">，每</span></font><font color="#0000FF" face="Times New Roman" size="2"><span style="font-size:10pt">1000</span></font><font color="#0000FF" face="宋体" size="2"><span style="font-size:10pt">个用户访问时，会完整的进行一次清理。</span></font></div></div></div><div align="left" style="min-height: 13pt;"><div><span style="font-size: 16px;"><b>11、session补充</b></span></div><div style="box-sizing: border-box; padding: 8px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">COOKIE删除后SESSION是否不再可用</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">1. 设置php.ini配置文件的“session.use_trans_sid = 1”，或编译时打开了“--enable-trans-sid”选项，让PHP自动跨页传递Session ID。</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">2. 手动通过URL传值、隐藏表单传递Session ID。</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">3. 用文件、数据库等形式保存Session ID，在跨页过程中手动调用。</span></span></span></div></div></div><div align="left" style="min-height: 13pt;"><div style="margin-left:40px;"><font color="#010101" face="KaiTi"><span style="font-size:12pt">session是基于cookie的，但是如果禁用cookie，只要用</span></font><font color="#010101" face="KaiTi"><span style="font-size:12pt">其他方式传递sessionid，session同样可以使用！</span></font></div></div><div align="left" style="min-height: 13pt;margin-left:40px;"><div><font color="#010101" face="KaiTi"><span style="font-size:12pt">例如：使用url的get方式传递sessionid。</span></font></div></div><div align="left" style="min-height: 13pt;margin-left:40px;"><div><font color="#010101" face="KaiTi"><span style="font-size:12pt">如果需要使用get方式传递sessionid，修改php.ini配置：</span></font></div></div><div style="margin-left:40px;">第一步：session.use_cookies = 0</div><div style="margin-left:40px;">第二步：session.use_only_cookies = 0</div><div style="margin-left:40px;">第三步：session.use_trans_sid = 1</div><div style="box-sizing: border-box; padding: 8px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">实例：1第二次登录显示上次登录时间2设置session</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">if ($_COOKIE) {</span></span></span> <span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">  echo &quot;欢迎再次光临，上次登录时间&quot;.&quot;$_COOKIE[lasttime]&quot;;</span></span></span> <span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);"> }</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">         else {</span></span></span> <span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">  echo &quot;欢迎光临&quot;;</span></span></span> <span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">  }</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    setcookie(&quot;lasttime&quot;,date('Y-m-d H:i:s',time()),time()+300);</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    session_start();</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    $_SESSION['username1']='admin';</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    print_r($_SESSION);</span></span></span></div></div></div></span>
</div></body></html> 