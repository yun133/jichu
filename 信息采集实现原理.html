<html>
<head>
  <title>信息采集实现原理</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303788 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="3033"/>
<h1>信息采集实现原理</h1>

<div>
<span><div><h2 align="justify"><font color="#333333" face="黑体" size="5"><span style="font-size:18pt"><b>信息采集实现原理</b></span></font></h2><div align="justify" style="min-height: 13pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">一个网站去采集另外一个网站的信息，可以通过如下几种方式实现：</span></font></div><div align="justify" style="min-height: 14pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">①</span></font> <font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">file_get_contents();</span></font></div><div align="justify" style="min-height: 14pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">②</span></font> <font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">fsockopen()</span></font></div><div align="justify" style="min-height: 14pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">③</span></font> <font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">curl</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">方式</span></font></div><div align="justify" style="min-height: 14pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">等等</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">(</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">也还有其他方式</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">)</span></font></div><div align="justify" style="min-height: 14pt;"><div><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">采集本质原理：</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">php</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">语言可以允许跨域请求其他网站网址，并获得网址对应的源代码内容。</span></font></div><div><span style="color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">PHP里做一般的获取内容时，用自带的file_get_contents()函数基本就足够了。</span> <span style="color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">如果是遇到需要登录的页面，</span> <span style="color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">还是需要curl。</span></div><div><span style="color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">注意：要在PHP.ini中对curl的extension前面的分号去掉，</span><span style="color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">file_get_contents()</span><span style="color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">还要把openssl的扩展同样打开</span></div></div><h3 align="justify"><font color="#333333" face="Courier New" size="4"><span style="font-size:16pt"><b>5.1 file_get_contents()</b></span></font></h3><div align="justify" style="min-height: 169pt;"><img src="信息采集实现原理_files/Image.png" type="image/png" alt="graphic" border="0" height="226" style="height: auto;" width="546"/></div><div align="justify" style="min-height: 14pt;"><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">file_get_contents()</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">函数实现的作用：</span></font></div><div align="justify" style="min-height: 13pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">①</span></font> <font color="#333333" face="黑体" size="2"><span style="font-size:10pt">打开本地服务器的文件</span></font></div><div align="justify" style="min-height: 13pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">②</span></font> <font color="#333333" face="黑体" size="2"><span style="font-size:10pt">可以向其他网络地址发起请求</span></font></div><div align="justify" style="min-height: 13pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">采集的效果：</span></font></div><div align="justify" style="min-height: 228pt;"><img src="信息采集实现原理_files/Image [1].png" type="image/png" alt="graphic" border="0" height="305" style="height: auto;" width="549"/></div><h3 align="justify"><font color="#333333" face="Courier New" size="4"><span style="font-size:16pt"><b>5.2 fsockopen()</b></span></font></h3><div align="justify" style="min-height: 14pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">通过</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">fsockopen()</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">发起请求：</span></font></div><div align="justify" style="min-height: 242pt;"><img src="信息采集实现原理_files/Image [2].png" type="image/png" alt="graphic" border="0" height="323" style="height: auto;" width="546"/></div><div align="justify" style="min-height: 13pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">请求效果：</span></font></div><div align="justify" style="min-height: 261pt;"><img src="信息采集实现原理_files/Image [3].png" type="image/png" alt="graphic" border="0" height="349" style="height: auto;" width="551"/></div><h3 align="justify"><font color="#333333" face="Courier New" size="4"><span style="font-size:16pt"><b>5.3 curl</b></span></font><font color="#333333" face="黑体" size="4"><span style="font-size:16pt"><b>方式</b></span></font></h3><div align="justify" style="min-height: 14pt;"><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">curl</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">是</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">php</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">的一个扩展，类似</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">gd</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">库一样</span></font></div><div align="justify" style="min-height: 14pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">在</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">php.ini</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">打开其扩展</span></font></div><div align="justify" style="min-height: 119pt;"><img src="信息采集实现原理_files/Image [4].png" type="image/png" alt="graphic" border="0" height="159" style="height: auto;" width="548"/></div><div align="justify" style="min-height: 14pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">之后</span><span style="font-size:10pt; background:#ffff00">重启</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt; background:#ffff00">apache </span><span style="font-size:10pt">  </span></font></div><div align="justify" style="min-height: 74pt;"><img src="信息采集实现原理_files/Image [5].png" type="image/png" alt="graphic" border="0" height="99" style="height: auto;" width="501"/></div><div align="justify" style="min-height: 14pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">上图，在</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">php.ini</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">中已经开启了</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">php_curl.dll</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">扩展，并且还有上图错误</span></font></div><div align="justify" style="min-height: 13pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">解决：</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:7mm; margin-top:0.00mm; margin-bottom:0.00mm;min-height: 14pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">在</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">php</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">的目录复制两个文件粘贴到系统目录</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:7mm; margin-top:0.00mm; margin-bottom:0.00mm;min-height: 37pt;"><img src="信息采集实现原理_files/Image [6].png" type="image/png" alt="graphic" border="0" height="50" style="height: auto;" width="308"/></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:7mm; margin-top:0.00mm; margin-bottom:0.00mm;min-height: 62pt;"><img src="信息采集实现原理_files/Image [7].png" type="image/png" alt="graphic" border="0" height="83" style="height: auto;" width="388"/></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:7mm; margin-top:0.00mm; margin-bottom:0.00mm;min-height: 46pt;"><img src="信息采集实现原理_files/Image [8].png" type="image/png" alt="graphic" border="0" height="62" style="height: auto;" width="389"/></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:7mm; margin-top:0.00mm; margin-bottom:0.00mm;min-height: 14pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">上边</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">php</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">目录的两个文件复制粘贴到系统目录：</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">C:\Windows\System</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:7mm; margin-top:0.00mm; margin-bottom:0.00mm;min-height: 121pt;"><img src="信息采集实现原理_files/Image [9].png" type="image/png" alt="graphic" border="0" height="162" style="height: auto;" width="501"/></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:7mm; margin-top:0.00mm; margin-bottom:0.00mm;min-height: 14pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">之后。</span><span style="font-size:10pt; background:#ffff00">重启</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt; background:#ffff00">apache</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:7mm; margin-top:0.00mm; margin-bottom:0.00mm;min-height: 14pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">再次查看</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">phpinfo,</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">就发现</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">curl</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">是</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">ok</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">的：</span></font></div><div align="justify" style="margin-left:0mm; margin-right:0mm; text-indent:7mm; margin-top:0.00mm; margin-bottom:0.00mm;min-height: 187pt;"><img src="信息采集实现原理_files/Image [10].png" type="image/png" alt="graphic" border="0" height="250" style="height: auto;" width="518"/></div><div align="justify" style="min-height: 14pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">通过</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">curl</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">实现信息采集：</span></font></div><div align="justify" style="min-height: 225pt;"><img src="信息采集实现原理_files/Image [11].png" type="image/png" alt="graphic" border="0" height="301" style="height: auto;" width="552"/></div><div align="justify" style="min-height: 13pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">访问效果：</span></font></div><div align="justify" style="min-height: 231pt;"><div><img src="信息采集实现原理_files/Image [12].png" type="image/png" alt="graphic" border="0" height="309" style="height: auto;" width="550"/></div><div style="margin: 0px; padding: 0px; color: rgb(0, 0, 0); font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;"><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>&lt;?php</div><div>function file_get_contents_by_curl($url){//将curl封装为函数</div><div>$ch = curl_init();//初始化 cURL 会话</div><div>curl_setopt($ch, CURLOPT_URL,$url);     //请求的URL</div><div>curl_setopt($ch, CURLOPT_HEADER,0);     //启用时会将头文件的信息作为数据流输出</div><div>curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);//禁止调用时就输出获取到的数据</div><div>curl_setopt($ch, CURLOPT_FOLLOWLOCATION,1);//TRUE 时将会根据服务器返回 HTTP 头中的 &quot;Location: &quot; 重定向</div><div>curl_setopt($ch, CURLOPT_SSL_VERIFYPEER,false);//禁用SSL校验</div><div>curl_setopt($ch, CURLOPT_SSL_VERIFYHOST,false);</div><div>$result = curl_exec($ch);</div><div>curl_close($ch);</div><div>return $result;</div><div>}</div></div><div><span style="font-family: Verdana, Arial, Helvetica, sans-serif;">这两行才是关键。</span></div><div><span style="font-family: Verdana, Arial, Helvetica, sans-serif;">curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);</span></div><div><span style="font-family: Verdana, Arial, Helvetica, sans-serif;">curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);</span></div><div><span style="font-family: Verdana, Arial, Helvetica, sans-serif;">算是一小段救命代码，以前知道的看完一笑就好了，主要为不知道的朋友们准备。</span></div></div></div><h2 align="justify"><font color="#333333" face="Courier New" size="5"><span style="font-size:18pt"><b>6.</b></span></font> <font color="#333333" face="黑体" size="5"><span style="font-size:18pt"><b>图片采集实现</b></span></font></h2><div align="justify" style="min-height: 13pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">信息采集效果，采集电影列表页面的许多“</span><span style="font-size:10pt; background:#ffff00">图片</span><span style="font-size:10pt">”内容，存储到本地：</span></font></div><div align="justify" style="min-height: 14pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">通过</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">file_get_contents()</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">实现</span></font></div><div align="justify" style="min-height: 66pt;"><img src="信息采集实现原理_files/Image [13].png" type="image/png" alt="graphic" border="0" height="89" style="height: auto;" width="551"/></div><div align="justify" style="min-height: 14pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">采集图片本质原理，获得上图的</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">img</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">标签的</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">src</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">属性值，并对该属性值发起请求，这样就会获得</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">img</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">图片的二进制码内容，然后给该二进制码存储到一个文件中，该文件就是物理图片。</span></font></div><div align="justify" style="min-height: 12pt;"><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">                                                    </span></font></div><div align="justify" style="min-height: 14pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">模式修正符</span></font><font color="#FF0000" face="Times New Roman" size="2"><span style="font-size:10pt">U </span></font> <font color="#333333" face="黑体" size="2"><span style="font-size:10pt">避免贪婪匹配：</span></font></div><div align="justify" style="min-height: 63pt;"><img src="信息采集实现原理_files/Image [14].png" type="image/png" alt="graphic" border="0" height="84" style="height: auto;" width="480"/></div><div align="justify" style="min-height: 14pt;"><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">preg_match_all()</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">全局匹配：</span></font></div><div align="justify" style="min-height: 87pt;"><img src="信息采集实现原理_files/Image [15].png" type="image/png" alt="graphic" border="0" height="117" style="height: auto;" width="482"/></div><div align="justify" style="min-height: 13pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">匹配到的结果示意：</span></font></div><div align="justify" style="min-height: 176pt;"><img src="信息采集实现原理_files/Image [16].png" type="image/png" alt="graphic" border="0" height="235" style="height: auto;" width="548"/></div><div align="justify" style="min-height: 14pt;"><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">strrchr(</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">字符串，</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">@)</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">使用</span></font></div><div align="justify" style="min-height: 14pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">字符串：</span></font><a href="mailto:xiaoming@163.com"><font color="#0000FF" face="Times New Roman" size="2"><span style="font-size:10pt"><u>xiao@ming@163.com</u></span></font></a></div><div align="justify" style="min-height: 14pt;"><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">strrchr</span></font><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">的结果：</span></font><font color="#333333" face="Times New Roman" size="2"><span style="font-size:10pt">@163.com</span></font></div><div align="justify" style="min-height: 47pt;"><img src="信息采集实现原理_files/Image [17].png" type="image/png" alt="graphic" border="0" height="63" style="height: auto;" width="550"/></div><div align="justify" style="min-height: 13pt;"><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">实现外部电影网站的</span><span style="font-size:10pt; background:#ffff00">图片</span><span style="font-size:10pt">采集功能：</span></font></div><div align="justify" style="min-height: 228pt;"><img src="信息采集实现原理_files/Image [18].png" type="image/png" alt="graphic" border="0" height="304" style="height: auto;" width="551"/></div><div align="justify" style="min-height: 188pt;"><img src="信息采集实现原理_files/Image [19].png" type="image/png" alt="graphic" border="0" height="251" style="height: auto;" width="550"/></div><div align="justify" style="min-height: 13pt;"><div><font color="#333333" face="黑体" size="2"><span style="font-size:10pt">采集到的物理图片效果：</span></font></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div><b>    header('Content-type:text/html;charset=gb2312');</b></div><div><b>    $url=&quot;http://www.6vhao.net&quot;;</b></div><div><b>    $all=file_get_contents_by_curl($url);//1获取网页所有静态页面</b></div><div><b>    // var_dump($all);die;</b></div><div><b>    //2正则匹配出img标签，非贪婪匹配，第一次匹配到就好</b></div><div><b>    $reg=&quot;/&lt;img.+src=\&quot;(.*)\&quot;/U&quot;;</b></div><div><b>    preg_match_all($reg, $all, $outs);//3根据匹配规则得到所有图片信息到数组$outs</b></div><div><b>    var_dump($outs);</b></div><div><b>    $dir=&quot;./pic&quot;;</b></div><div><b>    foreach ($outs[1] as $key =&gt; $v) {//[0]是完整标签，[1]是url数组</b></div><div><b>        // var_dump($v);</b></div><div><b>        $name=strrchr($v,'/');    //4截取url中包含的文件名</b></div><div><b>        $imgc=file_get_contents_by_curl($v);//5获取图片流内容</b></div><div><b>        file_put_contents($dir.$name, $imgc);//6保存图片到组装好的文件名中</b></div><div><b>    }</b></div><div><b>//封装curl为函数</b></div><div>    function file_get_contents_by_curl($url){//将curl封装为函数</div><div>        $ch = curl_init();//初始化 cURL 会话</div><div>        curl_setopt($ch, CURLOPT_URL,$url);     //请求的URL</div><div>        curl_setopt($ch, CURLOPT_HEADER,0);     //启用时会将头文件的信息作为数据流输出</div><div>        curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);//禁止调用时就输出获取到的数据</div><div>        curl_setopt($ch, CURLOPT_FOLLOWLOCATION,1);//TRUE 时将会根据服务器返回 HTTP 头中的 &quot;Location: &quot; 重定向</div><div>        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER,false);//禁用SSL校验</div><div>        curl_setopt($ch, CURLOPT_SSL_VERIFYHOST,false);</div><div>        $result = curl_exec($ch);</div><div>        curl_close($ch);</div><div>        return $result;</div><div>    }</div></div><div><img src="信息采集实现原理_files/Image [20].png" type="image/png" alt="graphic" border="0" height="174" style="height: auto;" width="545"/></div></div></div></span>
</div></body></html> 