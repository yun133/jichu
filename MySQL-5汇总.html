<html>
<head>
  <title>MySQL-5汇总</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303788 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1267"/>
<h1>MySQL-5汇总</h1>

<div>
<span><div><span style="font-size: 19px;"><b>MySQL-5汇总</b></span></div><div><span style="font-size: 16px;"><b>一、数据库操作语句</b></span></div><div style="margin-left:40px;"><span style="font-size: 15px;"><b>mysql -hlocalhost -p3306 -uroot -proot</b></span></div><div style="margin-left:40px;"><span style="font-size: 15px;"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">SHOW DATABASE<span style="color: rgb(255, 0, 0);">S</span>;</span></b></span></div><div style="margin-left:40px;"><span style="font-size: 15px;"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">SHOW CREATE DATABASE db_name；</span> </b></span></div><div style="margin-left:40px;"><span style="font-size: 15px;"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">CREATE DATABASE [IF NOT EXISTS] db_name [CHARSET 字符集];</span></b></span></div><div style="margin-left:40px;"><span style="font-size: 15px;"><b>USE db_name;</b></span></div><div style="margin-left:40px;"><span style="font-size: 15px;"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">DROP DATABASE [IF EXISTS ] db_name；</span></b></span></div><div style="margin-left:40px;"><span style="font-size: 15px;"><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">alter database db1 charset=utf8;</span></span></div><div style="margin-left:40px;"><span style="font-size: 15px;"><b><font color="#010101"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">SHOW TABLES [FROM 表名];</span></font></b></span></div><div style="margin-left:40px;"><span style="font-size: 15px;"><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><font color="#010101"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">DESC tb_name;</span></font></span></span></div><div style="margin-left:40px;"><span style="font-size: 15px;"><b><font color="#010101"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">SHOW CREATE TABLE tb_name;</span></font></b></span></div><div style="margin-left:40px;"><span style="color: rgb(255, 0, 0);"><span style="font-size: 15px;"><b>linux下mysql设置远程连接详见Linux-3关闭防火墙和设置远程连接。</b></span></span></div><div style="margin-left:40px;"><b><span style="font-size: 15px;"><span style="color: rgb(255, 0, 0);">Mysql注释方法1-- 注释（注意：--后面要有空格）；注释方法2#</span></span></b></div><div><span style="font-size: 16px;"><b>二、建表语句</b></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div><span style="color: rgb(255, 0, 0);">set names gbk;</span>//在cmd中必须设置，否则返回ERROR 1067 (42000): Invalid default value for 'gender'</div><div>例 create table if not exists stu1(</div><div>    id int not null primary key auto_increment,</div><div>    name varchar(4) not null unique key,</div><div>    gender enum('男','女','保密') not null default '保密',</div><div>    age tinyint,</div><div>    salary float not null default 0,</div><div>    grad_time date comment '毕业时间',</div><div>    intro text comment '自我介绍'             //注意这里不能有,逗号</div><div>    )charset =utf8;</div></div><div style="margin-left:40px;"><b>修改表、字段</b></div><div style="margin-left:40px;"><b>alter table student1 add ismarry char(1) not null default '否';//添加字段</b></div><div style="margin-left:40px;"><font color="#FF0000" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">alter </span></font><font color="#010101" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">table tb_name </span></font><font color="#FF0000" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">modify  </span></font><font color="#010101" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;"><b>col_name</b>  <b><span style="color: rgb(229, 0, 255);">col_type</span>  col_attr;</b></span></font></div><div style="margin-left:40px;"><font color="#FF0000" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">alter </span></font><font color="#010101" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">table tb_name </span></font><font color="#FF0000" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">change </span></font><font color="#010101" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;"><b>col_name <span style="color: rgb(255, 0, 0);">new_col_name</span> <span style="color: rgb(229, 0, 255);">col_type;改字段</span></b></span></font></div><div style="margin-left:40px;"><font color="#FF0000" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">ALTER </span></font><font color="#010101" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">TABLE table_name </span></font><font color="#FF0000" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">DROP</span></font><font color="#010101" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">[COLUMN] col_name, DROP [COLUMN] col_name,</span></font><font color="#010101" face="宋体"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">……；</span></font></div><div style="margin-left:40px;"><font color="#FF0000" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">ALTER </span></font><font color="#010101" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">TABLE table_name </span></font><font color="#FF0000" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">DROP Index</span></font><font color="#010101" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;"> col_name;//</span></font><span style="font-family: 宋体;"><span style="color: rgb(1, 1, 1);">alter table student1 drop index name;可删除unique唯一键索引</span></span></div><div style="margin-left:40px;"><font color="#FF0000" face="Calibri" style="text-indent: 0pt;"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">alter </span></font><font color="#010101" face="Calibri" style="color: rgb(1, 1, 1); text-indent: 0pt;"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">table tb_name </span></font><font color="#FF0000" face="Calibri" style="text-indent: 0pt;"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">rename </span></font><font color="#010101" face="Calibri" style="color: rgb(1, 1, 1); text-indent: 0pt;"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">new_tb;</span></font></div><div style="margin-left:40px;"><font color="#FF0000" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">drop </span></font><font color="#010101" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">table [if exits] tb_name;</span></font></div><div style="margin-left:40px;"><font color="#010101" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">create table tb_name1 <b>like</b> tb_name2;//表结构</span></font></div><div style="margin-left:40px;"><font color="#010101" face="Calibri"><span style="background-color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial;">create table 表名1 select * <b>from</b> 表2;</span></font></div><div><b><span style="font-size: 16px;">-------------------------------------------------------------------------------------</span></b></div><div style="margin-left:40px;"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">show character set;</span></b></div><div style="margin-left:40px;">show variables like 'character_set_%';</div><div style="margin-left:40px;"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">show collation;</span></b></div><div style="margin-left:40px;"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">show variables like 'character_set%';</span></b></div><div style="margin-left:40px;"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">set names gbk；三表合一设置字符集</span></b></div><div style="margin-left:40px;"><b>show engines;</b></div><div style="margin-left:40px;"><b>1、创建索引---在建表完成后添加</b></div><div style="margin-left:40px;"><b>alter table tb3 engine innodb;</b></div><div style="margin-left:40px;"><b>alter table tb3 add index(id);</b></div><div style="margin-left:40px;"><b>alter table tb3 add unique index `index_sn`  (`sn`)；</b></div><div style="margin-left:40px;"><b>2、创建索引---直接在建表时创建</b></div><div style="margin-left:40px;"><b>primary key (`id`)</b></div><div style="margin-left:40px;"><b>index `index_name` (`xing`,`ming`)</b></div><div style="margin-left:40px;"><b>unique index `index_sn` (`sn`)</b></div><div style="margin-left:40px;"><b>fulltext index `index_intro` (`index`)</b></div><div><b><span style="font-size: 16px;">三、增改删查----------------------------------------------------------------------------------------------</span></b></div><div><i><b><span style="font-size: 16px;"><span style="color: rgb(255, 0, 0);">增 </span>i</span>nsert into student1 (name,age) values ('张小兽',23);</b></i></div><div style="margin-left:40px;"><i><b>insert into student1 set name='郑容和',age=27,salary=3000;</b></i></div><div style="margin-left:40px;"><b><i>insert into student1 (name,age) values ('郭靖',23),('黄蓉',22),('杨过',25),('小龙女',26);</i></b></div><div style="margin-left:40px;"><i><b>insert into student1(name,intro) select name,intro from student1;//只复制了名字和介绍，其他默认</b></i></div><div><b><span style="color: rgb(255, 0, 0);"><span style="font-size: 16px;">改</span></span>update 表名 set 字段1=值1，字段2=值2,…[<span style="color: rgb(255, 0, 0);">where 条件</span>]；//</b><i><b>update student1 set gender='男' where id=9 <span style="color: rgb(255, 0, 0);">or</span> id=11;//同时修改两条记录</b></i></div><div><i><b><span style="font-size: 16px;"><span style="color: rgb(255, 0, 0);">删</span> d</span>elete from student1 where id=6;</b></i>//执行delete后id=6无数据，但id会保留。</div><div style="margin-left:40px;"><b><span style="color: rgb(229, 0, 255);">truncate 表名；</span></b></div><div><span style="font-size: 16px;"><span style="color: rgb(255, 0, 0);"><b>查询操作（</b><b>select</b><b>）</b></span></span></div><div><span style="font-size: 16px;"><b>select[all|distinct]字段列表 * from 表名 [<span style="color: rgb(255, 0, 0);">where 条件</span>][<span style="color: rgb(255, 0, 0);">group by</span> 条件][<span style="color: rgb(255, 0, 0);">having by</span> 条件][<span style="color: rgb(255, 0, 0);">order by</span> 条件][<span style="color: rgb(250, 122, 0);">limit</span> 条件];</b></span></div><div style="margin-left:40px;">select unix_timestamp() from dual;//1483707354时间戳</div><div style="margin-left:40px;"><b><i>select id,name <span style="color: rgb(229, 0, 255);">as</span> 姓名,salary as 工资,address as 地址 from student1;//字段别名</i></b></div><div style="margin-left:40px;"><i>select all/distinct name as 姓名 from student1;//<b>distinct必须是所有字段的值都不同时才能用上</b></i></div><div style="margin-left:40px;"><b>where 条件+&gt;或&lt;或=     //</b><b><i>例1</i><i>select * from student1 where address='南方' and age<span style="color: rgb(255, 0, 0);">&lt;</span>23  or age is null;注意数据库中null无法做比较</i></b></div><div style="margin-left:40px;"><b>where +in（）或not in（）</b>，in后面罗列字段可取值，使用（）包括。select * from tb1 where name in('小华','张三');</div><div style="margin-left:40px;"><b>where+between或not between，where+is null或is not null</b></div><div style="margin-left:40px;">匹配符 <b>where</b>+<b>like + <span style="color: rgb(255, 0, 0);">'</span>%<span style="color: rgb(255, 0, 0);">'</span></b>匹配任意多个字符和like + <span style="color: rgb(255, 0, 0);">'</span>_<span style="color: rgb(255, 0, 0);">'</span>匹配一个字符。例：select * from tb1 where name like '%华' or name like '%三';</div><div style="margin-left:40px;"><i><b>select gender,count(gender) from student1 <span style="color: rgb(255, 0, 0);">group by</span> gender;</b></i>//显示表中所有男生和女生数量</div><div style="margin-left:40px;"><i><b>select <span style="color: rgb(255, 0, 0);">group_concat(name,age)</span> gender,count(gender) from student1 group by gender;</b></i>//显示男生和女生数量以及姓名、年龄</div><div style="margin-left:40px;"><i><b>select address,max(salary) from student1 group by address <span style="color: rgb(255, 0, 0);">having</span> max(salary)&gt;1000;</b></i></div><div style="margin-left:120px;"><i><b>//先按照地址，最高薪资分组，再筛选出分组结果中大于1000的地址和薪资信息。</b></i></div><div style="margin-left:40px;"><b><span style="color: rgb(255, 0, 0);">order by</span></b> <b>排序：select 字段列表 from 表名 [where 子句] [group by 子句] [having子句] <span style="color: rgb(255, 0, 0);">[order by子句];</span></b></div><div style="margin-left:40px;"><i><b>select * from student1 order by fenshu desc limit 3;//</b></i>显示语文考试前三名的个人信息<b>limit  <span style="color: rgb(255, 0, 0);">(page-1)*pagesize</span>，<span style="color: rgb(255, 0, 0);">pagesize</span>。（即</b><b>limit <span style="color: rgb(255, 0, 0);">m,n</span></b> <b>）</b></div><div style="margin-left:40px;"><b>查询总结：select 字段列表 from 表名 [where子句] [group by子句] [having子句] [order by子句] [limit 子句];</b></div><div><ul><li style="display:inline;list-style:none;"><ul><li>where子句可以进行条件判断，对from子句返回的结果集进行筛选</li></ul></li></ul><ul><li style="display:inline;list-style:none;"><ul><li>group by子句可以对数据进行分组</li></ul></li></ul><ul><li style="display:inline;list-style:none;"><ul><li>having子句可以对分组的结果集进行进一步的筛选</li></ul></li></ul><ul><li style="display:inline;list-style:none;"><ul><li>order by子句可对结果集进行排序</li></ul></li></ul><ul><li style="display:inline;list-style:none;"><ul><li>limit限制最终结果集的输出行数</li></ul></li></ul></div><ul><li style="display:inline;list-style:none;"><ul><li>注意各个子句之间的顺序不能错-----------------------------------------------------------------------------------</li></ul></li></ul><div><b><span style="font-size: 16px;">一、连接查询</span></b></div><div style="margin-left:40px;"><b>1、<span style="color: rgb(255, 0, 0);">内连接</span></b><b>inner join……on</b></div><div style="margin-left:120px;"><b>inner join语法：  select 字段列表 from 表1 <span style="color: rgb(229, 0, 255);">inner join</span> 表2 <span style="color: rgb(229, 0, 255);">on</span> <span style="color: rgb(255, 0, 0);">表1.字段=表2.字段</span>。</b></div><div style="margin-left:120px;"><b>例：select b1.*,b2.num2 from n1j1 as b1 inner join n2j2 as b2 on b1.id=b2.id;</b></div><div style="margin-left:40px;"><b><span style="color: rgb(255, 0, 0);">同理：三张表</span>的<span style="color: rgb(255, 0, 0);">内连接</span>查询</b><b>： select * from 表1 inner join 表2 on 条件 inner join 表3 on 条件。</b></div><div style="margin-left:40px;"><b> 2、<span style="color: rgb(255, 0, 0);">左连接</span></b><b>语法 : select 字段列表 from 表名 <span style="color: rgb(255, 0, 0);">left join</span> 表名 <span style="color: rgb(255, 0, 0);">on</span> 条件。</b></div><div style="margin-left:40px;"><b> 3、<span style="color: rgb(255, 0, 0);">右连接</span></b><b>语法： select * from 表1 <span style="color: rgb(255, 0, 0);">right join</span> 表2 <span style="color: rgb(255, 0, 0);">on</span> 条件</b></div><div style="margin-left:40px;"><b>4、</b><span style="color: rgb(255, 0, 0);"><b>自然内连接</b></span>natural join，<b><span style="color: rgb(255, 0, 0);">自然左</span>连接</b>natural left join，<b><span style="color: rgb(255, 0, 0);">自然右</span>连接</b>natural right join</div><div style="margin-left:40px;"><b>5、using()可部分情况代替on 条件。select * from n1j1 inner join n2j2 using(id);</b></div><div><span style="font-size: 16px;"><b>二、联合查询</b> <b>union,</b></span><b>连接查询</b>是将两张表<b>横向</b>的连接到一起，<span style="color: rgb(229, 0, 255);">联合查询</span>是将两张表<span style="color: rgb(229, 0, 255);">纵向</span>的连接到一起</div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>    select id,name from student where city like '%西%' order by salary desc limit 100     //工资降序</div><div>    union                                                                            //排序结果上下组合到一张表</div><div>    select id,name from student where age&gt;35 order by salary asc limit 100;               //工资升序</div></div><div><span style="font-size: 16px;"><b>三、子查询</b></span></div><div style="margin-left:40px;"><i><b>select * from student1 where salary&gt;(select avg(salary) from student1);</b></i><b><span style="color: rgb(255, 0, 0);">.标量子查询</span></b></div><div style="margin-left:40px;"><i><b>select * from student1 where age in(select age from student1 where name in('宋小花','周同学'));</b></i><b><span style="color: rgb(255, 0, 0);">列子查询</span></b></div><div style="margin-left:40px;"><b>where 字段 in|not in(子查询语句)，</b><b>where 字段 比较运算符 any(子查询语句)，</b><b>where 字段 比较运算符 all（子查询语句）</b></div><div style="margin-left:40px;"><b>select * from 表格 where(字段1,字段2) =(select 字段1,字段2 from 表);</b><b><span style="color: rgb(255, 0, 0);">行子查询</span></b></div><div style="margin-left:40px;"><b>select * from (表子查询的结果) as 表名</b><b><span style="color: rgb(255, 0, 0);">表子查询</span></b></div><div><span style="font-size: 16px;"><b>四、数据的备份及还原---------------------------------------------------------------------------------------</b></span></div><div style="margin-left:40px;">C:\WINDOWS\system32&gt;mysqldump -uroot -proot -d db3&lt;e:/db3.sql</div><div style="margin-left:40px;">C:\WINDOWS\system32&gt;mysqldump -uroot -proot <b><span style="color: rgb(255, 0, 0);">-B</span></b> db3&lt;e:/db3.sql导出数据库结构、表结构、表数据</div><div style="margin-left:40px;">C:\WINDOWS\system32&gt;mysql -uroot -proot db3&lt;e:/db3.sql     //<b>数据的还原</b></div><div style="margin-left:40px;">C:\WINDOWS\system32&gt;mysql -uroot -proot &lt;e:/db3.sql</div><div style="margin-left:40px;">mysql&gt;source e:/db3.sql;</div><div><span style="font-size: 16px;"><b>五、创建用户和用户授权</b></span></div><div style="margin-left:40px;"><b>1.显示所有的用户：<i>select host,user,password from mysql.user;</i></b></div><div style="margin-left:40px;"><i>create user 'hangzhou'@'localhost' identified by '123456';</i><b>.创建用户</b></div><div style="margin-left:40px;"><b>set password [for ‘user’@’ip地址’] = password(‘密码’);</b><b>设置密码</b></div><div style="margin-left:40px;"><b>grant 权限 on 数据库.表格 to ‘user’@’ip地址’[with grant option]</b><b>用户授权</b></div><div style="margin-left:40px;"><b>grant all privileges on *.* to ‘user ’@‘ip地址’//给用户赋予所有的权限</b></div><div style="margin-left:40px;"><b>  revoke all privileges on *.* from ‘user’@’ip地址’</b><b>移除用户的权限</b></div><div style="margin-left:40px;"><b>drop user ‘user’@’ip地址’</b><b>删除用户</b></div><div><span style="font-size: 16px;"><b>六、找回密码</b></span></div><ol><li>关闭mysql服务 net stop mysql</li><li>让mysql跳过验证密码的环节 mysqld --skip-grant-tables</li><li>打开一个新的cmd，然后直接输入mysql登陆</li><li>修改密码  update mysql.user set password=password(‘新密码’) where user=’root’;</li><li>tastkill /f /im mysqld   ||  tastkill /f /pid 3228  或者直接在任务管理器中结束mysqld任务</li><li>重新启动mysql服务即可正常登陆</li></ol><div style="font-weight: bold; font-size: 20px;"><font color="#010101" face="Calibri Light" size="4"><span style="font-size:16pt"><b>七、</b></span></font><font color="#010101" face="Calibri Light" size="4"><span style="font-size:16pt"><b>MySQL</b></span></font><font color="#010101" face="宋体" size="4"><span style="font-size:16pt"><b>中的预处理</b></span></font></div><div align="justify" style="min-height: 13pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">基本语法：</span></font></div><div style="border-top: solid 1px #3382ad; border-left: solid 1px #3382ad; border-right: solid 1px #3382ad;"><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:7mm; margin-top:0.00mm; margin-bottom:0.00mm;min-height: 18pt; background: #f0f7fd;"><font color="#3382AD" face="Courier New" size="2"><span style="font-size:10pt; background:#e0e0e0">//1</span></font><font color="#3382AD" face="宋体" size="2"><span style="font-size:10pt; background:#e0e0e0">、创建预处理语句</span></font></div></div><div style="border-left: solid 1px #3382ad; border-right: solid 1px #3382ad;"><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:7mm; margin-top:0.00mm; margin-bottom:0.00mm;min-height: 14pt; background: #f0f7fd;"><font color="#3382AD" face="Courier New" size="2"><span style="font-size:10pt; background:#e0e0e0">prepare </span></font> <font color="#3382AD" face="宋体" size="2"><span style="font-size:10pt; background:#e0e0e0">预处理指令 </span></font><font color="#3382AD" face="Courier New" size="2"><span style="font-size:10pt; background:#e0e0e0">from  SQL</span></font><font color="#3382AD" face="宋体" size="2"><span style="font-size:10pt; background:#e0e0e0">语句</span></font><font color="#3382AD" face="Courier New" size="2"><span style="font-size:10pt; background:#e0e0e0">(insert/delete/update/select)</span></font></div></div><div style="border-left: solid 1px #3382ad; border-right: solid 1px #3382ad;"><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:7mm; margin-top:0.00mm; margin-bottom:0.00mm;min-height: 14pt; background: #f0f7fd;"><font color="#3382AD" face="Courier New" size="2"><span style="font-size:10pt; background:#e0e0e0">//2</span></font><font color="#3382AD" face="宋体" size="2"><span style="font-size:10pt; background:#e0e0e0">、设置参数</span></font></div></div><div style="border-left: solid 1px #3382ad; border-right: solid 1px #3382ad;"><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:7mm; margin-top:0.00mm; margin-bottom:0.00mm;min-height: 10pt; background: #f0f7fd;"><font color="#3382AD" face="Courier New" size="2"><span style="font-size:10pt; background:#e0e0e0">set @value = value;</span></font></div></div><div style="border-left: solid 1px #3382ad; border-right: solid 1px #3382ad;"><div align="left" style="min-height: 14pt; background: #f0f7fd;"><font color="#3382AD" face="Courier New" size="2"><span style="font-size:10pt; background:#e0e0e0">    //3</span></font><font color="#3382AD" face="宋体" size="2"><span style="font-size:10pt; background:#e0e0e0">、执行预处理</span></font></div></div><div style="border-bottom: solid 1px #3382ad; border-left: solid 1px #3382ad; border-right: solid 1px #3382ad;"><div align="left" style="min-height: 18pt; background: #f0f7fd;"><div><font color="#3382AD" face="Courier New" size="2"><span style="font-size:10pt; background:#e0e0e0">    execute </span></font> <font color="#3382AD" face="宋体" size="2"><span style="font-size:10pt; background:#e0e0e0">预处理指令</span></font><font color="#3382AD" face="Courier New" size="2"><span style="font-size:10pt; background:#e0e0e0">;</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 12px;"><span style="color: rgb(51, 51, 51);">    prepare stmt1 from 'insert into user values (null,?,?,?)';//1创建预处理语句</span></span></div><div><span style="font-size: 12px;"><span style="color: rgb(51, 51, 51);">    set @username='zhangsan';//2设置参数</span></span></div><div><span style="font-size: 12px;"><span style="color: rgb(51, 51, 51);">    set @password=md5('123456');</span></span></div><div><span style="font-size: 12px;"><span style="color: rgb(51, 51, 51);">    execute stmt1 using @username,@password;//3执行预处理语句</span></span></div><div><span style="font-size: 12px;"><span style="color: rgb(51, 51, 51);">    select * from user;//4返回执行结果</span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>在php中的应用</div><div>$link=new mysqli('localhost','root','123456','test'); #连接数据库</div><div>if ($stmt=$link-&gt;<b>prepare(</b>&quot;select * from curl_songs_num where id in ($ids)&quot;)<b>)</b> { #预处理语句</div><div>    $stmt-&gt;<b>execute()</b>;    #执行查询语句</div><div>    $stmt-&gt;<b>bind_result(</b>$id,$title,$author,$cont<b>)</b>;    #给字段绑定参数</div><div>    while($stmt-&gt;fetch()){</div><div>     //$songs=...;</div><div>     echo &quot;&lt;span style='color:blue'&gt;$song[0]&lt;/span&gt;&lt;br&gt;$song[1]&lt;hr&gt;&quot;;</div><div>    }</div><div>}</div><div>$stmt-&gt;close();</div><div>$link-&gt;close();</div></div><div><span style="font-size: 12px;"><span style="color: rgb(51, 51, 51);"><br/></span></span></div></div></div></div><div>八、MySQL的事务</div><div align="justify" style="min-height: 13pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">①开启事务</span></font></div><div align="justify" style="min-height: 14pt;"><font color="#010101" face="Calibri" size="2"><span style="font-size:10pt">1</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">）标准事务：</span></font><font color="#010101" face="Calibri" size="2"><span style="font-size:10pt">start  transaction;</span></font></div><div align="justify" style="min-height: 13pt;"><font color="#FF0000" face="宋体" size="2"><span style="font-size:10pt">当提交或回滚一个事务之后，事务结束。接下来的操作不在事务操作范围之内。</span></font></div><div align="justify" style="min-height: 14pt;"><font color="#010101" face="Calibri" size="2"><span style="font-size:10pt">2</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">）语句事务：</span></font><font color="#010101" face="Calibri" size="2"><span style="font-size:10pt">set  autocommit = 0;</span></font></div><div align="justify" style="min-height: 13pt;"><font color="#FF0000" face="宋体" size="2"><span style="font-size:10pt">当提交或回滚一个事务之后，事务不会终止，后面的操作仍处于事务之中。</span></font></div><div align="justify" style="min-height: 14pt;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">②提交事务：</span></font><font color="#010101" face="Calibri" size="2"><span style="font-size:10pt">commit;</span></font></div><div align="justify" style="min-height: 14pt;"><div><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">③回滚事务：</span></font><font color="#010101" face="Calibri" size="2"><span style="font-size:10pt">rollback;</span></font></div></div></span>
</div></body></html> 