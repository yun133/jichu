<html>
<head>
  <title>/** PHP函数集合</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303788 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1403"/>
<h1>/** PHP函数集合</h1>

<div>
<span><div style="margin-left:40px;"><b>/** PHP函数集合</b></div><div style="margin-left:40px;"><b>    * 1输出1-10000000以内的所有质数。</b></div><div style="margin-left:40px;"><b>    * 2展示出一个目录下面所有的文件</b></div><div style="margin-left:40px;"><b>    * 3统计出一个文件夹下面目录的数量和文件的数量 引用传值</b></div><div style="margin-left:40px;"><b>    * 4统计出一个文件夹下面目录的数量和文件的数量 累加</b></div><div style="margin-left:40px;"><b>    * 5删除一个目录及其文件</b></div><div style="margin-left:40px;"><b>    * 6递归求桃子</b></div><div style="margin-left:40px;"><b>    *</b></div><div style="margin-left:40px;"><b>*/</b></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>    /**1</div><div>    * 输出1-10000000以内的所有质数。</div><div>    * 1. 先将n开平方缩小范围</div><div>    * 2. 再将所有质数放在数组中</div><div>    * 3. 分别将要计算的数字去除以小于开平方n的数组中的每一个数字，如果都除不尽，那么这个数字也是质数</div><div>    */</div><div>    $arr[]=2;</div><div>    $len=1;</div><div>    for($i=2;1;$i++){</div><div>        for($m=0,$n=sqrt($i);$m&lt;$len&amp;&amp;$arr[$m]&lt;=$n;$m++){</div><div>            if($i%$arr[$m]==0){ continue 2;}</div><div>        }</div><div>        echo $i,' ';</div><div>        $arr[]=$i;</div><div>        $len=count($arr);</div><div>    }</div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    /**2</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    * 展示出一个目录下面所有的文件</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    * @param string $dir 要遍历的目录路径</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    * @return void</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    */</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    function showAllFiles($dir,$b=''){</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        if(! file_exists($dir)){e</span></span></span><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">cho  &quot;请输入一个正确路径！&quot;;</span></span></span> <span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">  return false;}   </span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        $handle = opendir($dir);// 打开句柄</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        // 当文件名为0的时候，判断是否全等于false，不全等于false继续执行</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        while(($fileName = readdir($handle))||($fileName!==false)){</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            if(($fileName=='.')||($fileName=='..')){</span></span></span> <span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">continue;</span></span></span> <span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">}</span></span></span><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">// 过滤.和..</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            $fileZuhe = &quot;$dir/$fileName&quot;;// 拼接完整路径</span></span></span><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            </span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            $fileName = iconv('gbk', 'utf-8', $fileName);</span></span></span><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">// 将操作系统的gbk转为utf-8</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            if(is_dir(</span></span></span><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">$fileZuhe</span></span></span> <span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">)){// 如果是一个文件夹，递归</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">                echo $b,$fileName,'&lt;br/&gt;';</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">                showAllFiles(</span></span></span><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">$fileZuhe</span></span></span> <span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">,$b.'--|');</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            }else{</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">                echo $b,$fileName,'&lt;br/&gt;';</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            }</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        }</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        closedir($handle);// 关闭句柄，释放资源</span></span></span></div><div><span style="color: rgb(51, 51, 51);"><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     </span></span></span>}<br/></div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">/**3</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    * 统计出一个文件夹下面目录的数量和文件的数量 引用传值</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    * @param string $dir 要统计数量的目录</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    * @return array(文件夹数量，文件数量)</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    */</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    function countDirA($dir,&amp;$dirNum=0,&amp;$fileNum=0){</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        $handle = opendir($dir);// 打开句柄</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        // 当文件名为0的时候，判断是否全等于false，不全等于false继续执行</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        while(($fileName = readdir($handle))||($fileName!==false)){</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            if($fileName == '.' || $fileName == '..') continue;// 过滤.和..</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            $</span></span></span>fileName<span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);"> = &quot;$dir/$fileName&quot;;// 拼接完整路径</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            if(is_dir($</span></span></span>fileName<span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">)){</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">                $dirNum++;</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">                countDirA($</span></span></span>fileName<span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">,$dirNum,$fileNum);</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            }else{</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">                $fileNum++;</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            }</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        }</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        closedir($handle);// 关闭句柄</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        return array($dirNum,$fileNum);</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    }</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);"><br/></span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    /**4</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    * 统计出一个文件夹下面目录的数量和文件的数量 累加</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    * @param string $dir 要统计数量的目录</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    * @return array(文件夹数量，文件数量)</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    */</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    function countDirB($dir){</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        $dirNum = 0;// 定义文件夹数量，文件数量</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        $fileNum = 0;</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        $handle = opendir($dir);// 打开句柄</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        // 当文件名为0的时候，判断是否全等于false，不全等于false继续执行</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        while(($fileName = readdir($handle))||($fileName!==false)){</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            if($fileName == '.' || $fileName == '..') continue;// 过滤.和..</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            $</span></span></span>fileName<span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);"> = &quot;$dir/$fileName&quot;;// 拼接完整路径</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            if(is_dir($</span></span></span>fileName<span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">)){</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">                $dirNum++;</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">                $res = countDirB($</span></span></span>fileName<span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">);</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">                $dirNum += $res[0];</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">                $fileNum += $res[1];</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            }else{</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">                $fileNum++;</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            }</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        }</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        closedir($handle);</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        return array($dirNum,$fileNum);</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    }</span></span></span></div></div><div>    </div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>/**5</div><div>    * 删除一个目录</div><div>    * @param string $dir 要删除的目录</div><div>    * @return bool</div><div>    */</div><div>    header(&quot;content-type:text/html;charset=utf-8&quot;);</div><div>    //实例：递归删除指定目录及所有文件</div><div>    function delFile($dirf){</div><div>        $handle=opendir($dirf);//打开句柄</div><div>         //循环读取所有文件 ，当文件夹为0，0!==false是true，0文件名可读，括号 不能少：=号赋值优先级最低</div><div>        while (($fileName=readdir($handle))||$fileName!==false) {//记得是不全等号!==</div><div>            //！如果目录为“.”和“..”则跳过,这里不要写错，符号或“||”不要弄错，否则很危险 ！！！！！！！</div><div>          //今天就因为把||写成&amp;&amp;，差点将e盘清空，所以一定要慎之又慎！</div><div>            if($fileName=='.'||$fileName=='..')continue;</div><div>            $fielzuhe=&quot;$dirf/$fileName&quot;;</div><div>            if (is_dir($fielzuhe)) {//如果是目录则递归删除，如果是普通文件，直接删除</div><div>                delFile($fielzuhe);//递归调用</div><div>            } else {</div><div>                unlink($fielzuhe);//删除文件</div><div>            }</div><div>        }</div><div>        closedir($handle);//关闭句柄</div><div>        return rmdir($dirf);//删除目录</div><div>    }</div></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>    /**6递归求桃子</div><div>    *有一个猴子，偷到一堆桃子，第一天，他吃了桃子数量的一半多一个，第二天，他又吃了桃子剩下的一半又多一个。。。。第二十天，猴子发现还剩1个桃子了，问，这个猴子偷了多少个桃子。（递归算法）</div><div>    */</div><div>    function fn($n){</div><div>        //递归出口</div><div>        if($n==1){    return 1;}</div><div>        return (fn($n-1)+1)*2;</div><div>    }</div><div>    echo fn(20);</div></div><div><a href="http://blog.csdn.net/landylxy/article/details/55259665" style="color: rgb(102, 102, 102); text-decoration: none; font-family: &quot;Microsoft YaHei&quot;; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">无限级分类三种方法</a></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>- function sort($category,$parent_id=0,$level=0){</div><div>-         static $arr=array();</div><div>-         foreach($category as $k=&gt;$v){</div><div>-             if($v['parent_id']==$parent_id){</div><div>-                 $v['level']=$level;</div><div>-                 $arr[]=$v;</div><div>-                 unset($category[$k]);//已经排好等级的,从数组中移除，提高性能</div><div>-                 $this-&gt;sort($category,$v['id'],$level+1);</div><div>-             }</div><div>-         }</div><div>-         return $arr;</div><div>-     }</div><div>-//方法2</div><div>-     function sort2($category,$parent_id=0,$level=0){</div><div>-         $res=array();</div><div>-         foreach($category as $c){</div><div>-             if($c['parent_id']==$parent_id){</div><div>-                 $c['level']=$level;</div><div>-                 $arr[]=$c;</div><div>-                 $res=array_merge($arr,$this-&gt;sort2($category,$c['id'],$level+1));</div><div>-             }</div><div>-         }</div><div>-         return $res;</div><div>-     }</div><div>//方法3</div><div>- &lt;pre code_snippet_id=&quot;2210996&quot; snippet_file_name=&quot;blog_20170216_1_7442626&quot; class=&quot;html&quot; name=&quot;code&quot;&gt;   /**</div><div>-     * 得到分类级数，并将他们的上下级关系，体现在返回数组中</div><div>-     * @param unknown $category</div><div>-     * @param number $parent_id</div><div>-     * @param number $level</div><div>-     * @return multitype:array</div><div>-     */</div><div>-    function category($category,$parent_id=0,$level=0){</div><div>-         $arr=array();</div><div>-         foreach($category as $k=&gt;$v){</div><div>-             if($v['parent_id']==$parent_id){</div><div>-                 $v['level']=$level;</div><div>-                 $v['child']=$this-&gt;category($category,$v['id'],$level+1);</div><div>-                 $arr[]=$v;</div><div>-             }</div><div>-         }</div><div>-         return $arr;</div><div>-     }</div></div><div><b>一定要避过的大坑</b></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>解析JSON返回时出现数据格式不对无法打印的问题，可以通过浏览器查看元素发现在｛｝前多了&amp;#65279空白不可见字符</div><div>项目第n次提交</div><div>1天气接口</div><div>2写接口，返回商品信息 $goods=file_get_contents($url);</div><div>bug写接口收到数据却无法打印出</div><div>原因：php输出包含空白隐形字符&amp;#65279，在json前所以无法解析</div><div>解决方法</div><div>方法0:1 $fuhao1=strpos($goods,'{');2$goods=substr($goods,$fuhao);3$goods=json_decode($goods);</div><div>方法1：ob_clean()</div><div>方法2:文件删除，用sublime重新保存为utf8格式，切记不要用记事本保存</div><div>方法3:搜索去除utf-8文件的bom头的php代码</div></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>/**</div><div>    * 生成一个长度为3-6之间的验证码</div><div>    * @param int $len 验证码的长度</div><div>    * @return void</div><div>    */</div><div>    function makeCode($len=4){</div><div>        // 限制验证码的长度在3-6之间</div><div>        $len = ($len&gt;6) ? 6 : $len;</div><div>        $len = ($len&lt;3) ? 3 : $len;</div><div>        // 创建真彩色空画布</div><div>        $img = imagecreatetruecolor(100, 40);</div><div>        // 随机分配一个背景亮色</div><div>        $bgColor = imagecolorallocate($img, mt_rand(200,255), mt_rand(200,255), mt_rand(200,255));</div><div>        imagefill($img, 0, 0, $bgColor);      // 填充背景颜色</div><div>        // 字体库</div><div>        $str = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';</div><div>        // 字体最大索引下标</div><div>        $maxIndex = strlen($str)-1;</div><div>        $flag = 0;</div><div>        while($flag&lt;$len){</div><div>            // 给字体分配随机颜色</div><div>            $color = imagecolorallocate($img, mt_rand(0,180), mt_rand(0,180), mt_rand(0,180));</div><div>            // 给验证码里面写字</div><div>            $index = mt_rand(0,$maxIndex);</div><div>            // 水平坐标</div><div>            $x = (104-15*$len)/2+$flag*15;</div><div>            imagestring($img, 5, $x, 10, $str{$index}, $color);</div><div>            $flag++;</div><div>        }</div><div>        // 生成100个像素点(噪点)</div><div>        for($i=0; $i&lt;100; $i++){</div><div>            $color = imagecolorallocate($img, mt_rand(0,255), mt_rand(0,255), mt_rand(0,255));</div><div>            imagesetpixel($img, mt_rand(0,100), mt_rand(0,40), $color);</div><div>        }</div><div>        // 告诉浏览器以图像的形式打开</div><div>        header('Content-type:image/jpeg');</div><div>        // 输出</div><div>        imagejpeg($img);</div><div>        // 销毁</div><div>        imagedestroy($img);</div><div>    }</div></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>/**</div><div>    * 上传一个文件</div><div>    * @param array $file 上传文件的数组 里面有五个元素</div><div>    * @param int $maxSize 上传文件允许的最大大小</div><div>    * @param array $extArray 上传文件允许的扩展名数组</div><div>    * @param array $mimeArray 上传文件允许的mime类型</div><div>    * @param string $path 上传文件保存的路径</div><div>    * @return array array('success'=&gt;bool, 'error_code'=&gt;错误编号, 'error_info'=&gt;错误信息, 'save_path'=&gt;上传文件保存的路径)</div><div>    */</div><div>    function upload($file, $path, $maxSize=2097152, $extArray=array('jpg','png','gif','jpeg'), $mimeArray=array('image/jpeg','image/png','image/gif')){</div><div>        // 判断系统错误</div><div>        if($file['error']!=0){</div><div>            return changeCode($file['error']);</div><div>        }</div><div><br/></div><div>        // 判断逻辑错误</div><div>        // 判断是否超过了自定义的大小限制</div><div>        if($file['size']&gt;$maxSize){</div><div>            return changeCode(8);</div><div>        }</div><div>        // 判断文件扩展名是否符合规范</div><div>        $ext = explode('.', $file['name']);</div><div>        $ext = array_pop($ext);</div><div>        if(!in_array($ext, $extArray)){</div><div>            return changeCode(9);</div><div>        }</div><div><br/></div><div>        // 安全需要</div><div>        $finfo = finfo_open(FILEINFO_MIME);</div><div>        $mime = finfo_file($finfo, $file['tmp_name']);</div><div>        $mime = explode(';', $mime);</div><div>        // 取出数组的第一个元素</div><div>        $mime = array_shift($mime);</div><div>        if(!in_array($mime, $mimeArray)){</div><div>            return changeCode(5);</div><div>        }</div><div><br/></div><div>        // 拼接年月日类型的文件夹</div><div>        $destination = $path.date('Y-m-d-H-i',time());</div><div>        if(!is_dir($destination)){</div><div>            mkdir($destination, 0777, true);</div><div>        }</div><div><br/></div><div>        $destination .= '/'.uniqid().'.'.$ext;</div><div>        // 移动上传文件</div><div>        if(<b>move_uploaded_file</b>($file['tmp_name'], $destination)){</div><div>            return array('success'=&gt;true, 'error_code'=&gt;0, 'error_info'=&gt;'', 'save_path'=&gt;$destination);</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>    * 转换上传文件错误信息</div><div>    * @param int $error_code 上传文件的错误编号</div><div>    * @return array array('success'=&gt;bool, 'error_code'=&gt;错误编号, 'error_info'=&gt;错误信息, 'save_path'=&gt;上传文件保存的路径)</div><div>    */</div><div>    function changeCode($error_code){</div><div>        switch($error_code){</div><div>            // 上传的文件超过了 php.ini 中 upload_max_filesize 选项限制的值。</div><div>            case 1: $error_info = '上传文件过大';</div><div>            break;</div><div>            // 上传文件的大小超过了 HTML 表单中 MAX_FILE_SIZE 选项指定的值。</div><div>            case 2: $error_info = '上传文件过大';</div><div>            break;</div><div>            // 文件只有部分被上传。</div><div>            case 3: $error_info = '上传失败，请重新上传';</div><div>            break;</div><div>            // 没有文件被上传。</div><div>            case 4: $error_info = '没有选择上传文件';</div><div>            break;</div><div>            // 找不到临时文件夹。PHP 4.3.10 和 PHP 5.0.3 引进。</div><div>            case 6: $error_info = '异常错误，请联系管理员';</div><div>            break;</div><div>            // 其值为 7，文件写入失败。PHP 5.1.0 引进。</div><div>            case 7: $error_info = '异常错误，请联系管理员';</div><div>            break;</div><div>            // 超过了php端自定义的最大大小限制</div><div>            case 8: $error_info = '上传文件过大';</div><div>            break;</div><div>            // 文件扩展名不符合规范</div><div>            case 9: $error_info = '文件类型不正确';</div><div>            break;</div><div>            // 文件mime类型不正确</div><div>            case 5: $error_info = '/(ㄒoㄒ)/~~';</div><div>            break;</div><div>        }</div><div>        return array('success'=&gt;false, 'error_code'=&gt;$error_code, 'error_info'=&gt;$error_info, 'save_path'=&gt;'');</div><div>    }</div></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>&lt;!-- 5秒后跳转到http://www.baidu.com --&gt;</div><div>&lt;meta http-equiv=&quot;refresh&quot; content=&quot;5;http://www.baidu.com&quot; /&gt;</div><div>&lt;!-- 5秒后刷新页面 --&gt;</div><div>&lt;meta http-equiv=&quot;refresh&quot; content=&quot;5&quot; /&gt;</div><div>// 5秒后跳转到http://www.baidu.com</div><div>header('refresh:5;http://www.baidu.com');</div><div>// 5秒后刷新页面</div><div>header('refresh:5');</div></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>Header(&quot;Location: $url&quot;);//用HTTP头信息</div><div>echo '&lt;meta http-equiv=&quot;refresh&quot; content=&quot;10;url=https://www.baidu.com&quot;&gt;';//1、meta标签实现</div><div>&lt;script&gt;url=&quot;submit.php&quot;;window.location.href=url;&lt;/script&gt;//2、JavaScript实现</div><div>例：&lt;script&gt;window.location.href = 'https://www.baidu.com';&lt;/script&gt;;</div><div>&lt;script&gt;url=&quot;submit.php&quot;;window.open(\'url,\'\',\'_self\');&lt;/script&gt;</div><div>header(&quot;Location: Url&quot;);//3、PHP页面重定向实现</div></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>//JS页面刷新</div><div>1，history.go(0)</div><div>2，location.reload()<br/></div><div>3，location=location<br/></div><div>4，location.assign(location)<br/></div><div>5，document.execCommand('Refresh')<br/></div><div>6，window.navigate(location)<br/></div><div>7，location.replace(location)<br/></div><div>8，document.URL=location.href</div></div><div><br/></div></span>
</div></body></html> 